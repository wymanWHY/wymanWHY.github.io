---
title: bash变量
date: 2015-07-02 15:27:21
categories: shell
tags:
    - 脚本编程
    - bash
---

![](http://p7wcdketk.bkt.clouddn.com/18-5-2/3137327.jpg)

<!-- more -->

## 变量的定义 ##

变量定义的格式如下：

    变量名 = 字符串

变量名只能由字母、数字、下划线组成

**且只能有字母或下划线开头:**

    user1=test1
    _user2=test2

## 变量的赋值 ##

### 直接赋值 ###

对于 shell 中，变量是无类型的，即所有变量的值都是一串字符，即字符串，当然，也可以为空字符串。

对于变量的赋值需要注意的是：

- **在等号（=）的两边不能有空格**

- 如果在变量的值中包含空格，需要使用单引号（''）或者双引号（""）

- 如果赋值的是一个已存在的变量名，则会覆盖掉原有的内容

```
# 正确的定义
user1=user001
user2='user002'
user3="user003"

# 错误的定义
user4 =user004
user5= user005
user6 ='user006'
...
```

### 命令结果进行赋值 ###

除了使用上述的方式对变量进行赋值之外，我们还可以使用命令执行的结果进行赋值。一般有两种方式：

- 反引号（`）

- $(command)

使用反引号我们可以在字符串中执行命令，也可以直接引用命令执行的结果进行赋值，如下示例

```
# 直接使用反引号进行赋值
user1=`echo testuser`

# 也可以在字符串中执行命令
user2="testuser `echo MM`"

```

而对于在字符串中使用反引号执行命令，如果需要使用引号的话，则只能使用双引号。

第二种使用命令结果赋值的方式为使用 $()。直接将命令写在括号中即可，如下：

```
# 使用 $() 进行赋值
user1=$(echo user001)

# 查看 user1
echo $user1


```

### 使用 read 定义 ###

除了使用上述的方式定义变量之外，我们还可以使用 read。

read 命令可以读取标准输入的内容，然后将其赋给一个变量或数组，多用于接收用户输入。这里我们仅仅介绍使用 read 定义变量，关于数组的内容在后面我们会学习到。

常用的用法如下：

```
# 读取用户输入赋给变量 user1，输入完成后使用回车即可
$ read user1

# 读取用户输入赋给多个变量，user2，user3，输入的时候需要使用空格分隔
$ read user2 user3

# 使用命令提示符，提示输入
$ read -p "please enter your username:" user4

# -t 指定超时时间，即等待用户输入的时间，不会一直等待用户的输入，设置的时间单位为秒
$ read -p "username:" -t 5 user6 user7

# -s 不会显示输入的内容，
$ read -s user8


```

### 使用 declare 定义 ###

declare 属于 bash 的内建命令，可以声明变量并赋给声明的变量属性值。

常用的选项如下：

-r 设置只读，

-l 使值中所有的大写字母转换为小写

-u 小写转换为大写

![](http://p7wcdketk.bkt.clouddn.com/18-5-2/74508915.jpg)


##  引用变量 ##

在使用变量时，我们可以在字符串中引用变量，而针对于单引号和双引号，**如果需要使用引号，则必须使用双引号**:

![](http://p7wcdketk.bkt.clouddn.com/18-5-2/95755751.jpg)


## 特殊变量 ##

在 bash 中，还有两种特殊的变量，分别为位置参数和状态变量。

### 5.1 位置参数 ###

位置参数代表的是 bash 脚本执行时的命令行参数，也代表 bash 脚本中定义的函数参数，而关于函数的内容在后面的章节中我们会学习到。

如下表中的位置参数：



|变量|含义
|:-|:-|

|$n|传递给脚本或函数的参数。n 是一个非负的整数，表示第几个参数。例如，第一个参数是 $1，第二个参数是 $2。在 n 大于等于 10 的时候，需要使用 ${n}|


### 其它特殊参数 ###

除此之外，还有一些特殊的参数，需要注意的是，这些变量仅仅可以被引用，而不可以被修改，如下：

|变量|含义|
|:-|:-|
|$0|当前脚本的文件名|
|$#|传递给脚本或函数的参数数量|
|$*|传递给脚本或函数的所有参数|
|$?|获取执行上一个指令的执行状态返回值（0为成功，非零为失败）|
|$$|获取当前执行的 shell 脚本的进程号（PID）|
|$!|获取上一个在后台工作的进程的进程号|
|$_|获取在此之前执行的命令或脚本的最后一个参数|


## 删除变量 ##

对于定义的变量我们可以使用 `unset` 命令进行删除操作，两个常用的选项如下：

-f 仅删除函数

-v 仅删除变量



